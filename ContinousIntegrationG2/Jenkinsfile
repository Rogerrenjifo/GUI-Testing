pipeline {
  agent any
  stages{
    stage('Test'){
      steps{
        bat 'python --help'
      }
    }
    stage('Code Inspection'){
      steps{
        bat 'echo Test stage'
      }
    }
    // stage('Instalar dependencias') {
    //   steps {
    //     script {
    //       virtualenvDir = "${WORKSPACE}\\venv"  // Directorio del entorno virtual
    //       bat "python -m venv ${virtualenvDir}"  // Crear el entorno virtual
    //       bat "${virtualenvDir}\\bin\\pip install -r ${WORKSPACE}\\requeriments.txt"  // Instalar las dependencias en el entorno virtual
    //     }
    //   }
    // }
    stage('Verificar carpeta') {
      steps {
        script {
          def folderPath = "${WORKSPACE}\\requeriments.txt"

          if (isFileExist(folderPath)) {
            echo "La carpeta existe."
          } else {
            error "La carpeta no existe."
          }
        }
      }
    }
  }
}

def isFileExist(filePath) {
  def command = "IF EXIST ${filePath} (exit 0) ELSE (exit 1)"
  def result = bat returnStatus: true, script: command
  return result == 0
}
