pipeline {
  agent any
  environment {
    PYTHONPATH = "${WORKSPACE}\\"
    PASSWORD=credentials('PASSWORD')
    USER=credentials('USER')
    BROWSER="chrome"
    DEVICE="pc"
    DRIVER_PATH=".\\"
    IMPLICIT_TIMEOUT="25"
    CI_EXECUTION="False"
  }
  stages{
    stage('Install Dependencies') {
      steps {
        script {
          virtualenvDir = "${WORKSPACE}\\venv"
          bat "python -m venv ${virtualenvDir}"
          bat ".\\venv\\Scripts\\activate"
          bat "${virtualenvDir}\\Scripts\\pip install -r ${WORKSPACE}\\requeriments.txt"
        }
      }
    }
    stage('Test'){
      steps{
        bat '.\\venv\\Scripts\\robot  --outputdir .\\Blueprint\\Reports .\\Blueprint\\TestCases'
      }
      post {
        always {
          archiveArtifacts artifacts: '.\\Blueprint\\Reports', fingerprint: true
        }
      }
    }
  }
}
