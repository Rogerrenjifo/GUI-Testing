pipeline {
  agent any
  environment {
    PYTHONPATH = "${WORKSPACE}\\"
    PASSWORD=credentials('PASSWORD')
    USER=credentials('USER')
    BROWSER="chrome"
    DEVICE="pc"
    DRIVER_PATH=".\\"
    IMPLICIT_TIMEOUT="25"
    CI_EXECUTION="False"
  }
  stages{
    stage('Install Dependencies') {
      steps {
        script {
          virtualenvDir = "${WORKSPACE}\\venv"
          bat "python -m venv ${virtualenvDir}"
          bat ".\\venv\\Scripts\\activate"
          bat "${virtualenvDir}\\Scripts\\pip install -r ${WORKSPACE}\\requeriments.txt"
        }
      }
    }
    stage('Run Happy Path Test Cases'){
      steps{
        bat '.\\venv\\Scripts\\robot  --outputdir .\\Blueprint\\Reports -i HEADER_PROJECT_PAGE .\\Blueprint\\TestCases'
      }
      post {
        always {
          archiveArtifacts artifacts: 'Blueprint/Reports/log.html', fingerprint: true
          archiveArtifacts artifacts: 'Blueprint/Reports/report.html', fingerprint: true
          archiveArtifacts artifacts: 'Blueprint/Reports/output.xml', fingerprint: true
        }
      }
    }
    stage('Run Regretion Test Cases'){
      steps{
        bat 'echo Regretion'
      }
    //   post {
    //     always {
    //       archiveArtifacts artifacts: 'Blueprint/Reports/log.html', fingerprint: true
    //       archiveArtifacts artifacts: 'Blueprint/Reports/report.html', fingerprint: true
    //       archiveArtifacts artifacts: 'Blueprint/Reports/output.xml', fingerprint: true
    //     }
    //   }
    }
    stage('Run Projects Test Cases'){
      steps{
        bat 'echo Happy Path'
      }
    //   post {
    //     always {
    //       archiveArtifacts artifacts: 'Blueprint/Reports/log.html', fingerprint: true
    //       archiveArtifacts artifacts: 'Blueprint/Reports/report.html', fingerprint: true
    //       archiveArtifacts artifacts: 'Blueprint/Reports/output.xml', fingerprint: true
    //     }
    //   }
    }
  }
}
